# エクセル風タブ連結システム 設計仕様書

## 🎯 設計目標
- 上位スロットとサブスロットの視覚的一体感を向上
- どの上位スロットのサブスロットが展開中かを明確化
- サブスロットの位置を上位スロット直下に近づける
- エクセルのようなタブ連結UI/UXを実現

## 🔗 統一設計方針

### 1. タブ連結の視覚的表現
- **親スロット**: 薄いブルー背景 (`rgba(173, 216, 230, 0.3)`) + スカイブルー境界線
- **サブスロットエリア**: より薄いブルー背景 (`rgba(173, 216, 230, 0.2)`) + 連結境界線
- **境界線の連結**: 親の下部境界線とサブエリアの上部境界線を除去して視覚的統合

### 2. タブ風ラベル
- **背景**: グリーンのグラデーション (`#4CAF50` → `#45a049`)
- **形状**: 上部角丸 (`border-radius: 8px 8px 0 0`)
- **アイコン**: 📂 フォルダアイコン + スロット名

### 3. 位置調整システム
- サブスロットエリアを親スロットの水平位置に合わせる
- `margin-left` と `max-width` でレスポンシブ調整
- ウィンドウリサイズ時の自動再調整

### 4. 制御パネル連携
- サブスロット制御パネルもタブ連結スタイルを適用
- ブルー系グラデーション背景
- 境界線とシャドウで統一感を演出

## 📋 実装ファイル

### JavaScript
- **`js/subslot_toggle.js`**: メイン制御ロジック
  - `applyTabConnection(slotId, isActive)`: タブ連結適用/解除
  - `adjustSubslotPosition(slotId)`: 位置調整
  - `clearAllTabConnections()`: 全てのタブ連結クリア

### CSS
- **`style.css`**: 視覚スタイル定義
  - `.active-parent-slot`: 親スロットのタブ連結スタイル
  - `.active-subslot-area`: サブスロットエリアのタブ連結スタイル
  - `.tab-style`: タブ風ラベルスタイル
  - `.tab-connected`: 制御パネル連結スタイル

## 🔄 動作フロー

1. **サブスロット展開時**:
   - 他の全タブ連結をクリア (`clearAllTabConnections()`)
   - 親スロットに `.active-parent-slot` 追加
   - サブエリアに `.active-subslot-area` 追加
   - ラベルに `.tab-style` 追加とテキスト更新
   - 位置調整実行 (`adjustSubslotPosition()`)
   - 制御パネルに `.tab-connected` 追加

2. **サブスロット閉じる時**:
   - 全タブ連結スタイルクリア
   - 位置調整スタイルリセット
   - 制御パネル削除

3. **ウィンドウリサイズ時**:
   - 展開中のサブスロットの位置を再調整

## 🎨 視覚的統一要素

### カラーパレット
- **メインブルー**: `#87CEEB` (スカイブルー)
- **背景ブルー**: `rgba(173, 216, 230, 0.3)` (親) / `rgba(173, 216, 230, 0.2)` (子)
- **タブグリーン**: `#4CAF50` → `#45a049`
- **境界線**: `#87CEEB` (2px solid)

### エフェクト
- **アニメーション**: `tabConnect` (0.3s ease-out)
- **シャドウ**: 連結感を演出する多層シャドウ
- **ホバー効果**: 親スロットのリフトアップ効果

## 🚀 今後の拡張予定
- タブの順序変更機能
- 複数サブスロット同時展開対応
- タブアニメーションの改善
- アクセシビリティ対応

## 📝 注意事項
- 一度に1つのサブスロットのみ展開可能
- 位置調整はCSSカスタムプロパティとinlineスタイルの併用
- ブラウザウィンドウサイズに応じた動的調整
