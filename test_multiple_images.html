<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¤‡æ•°ç”»åƒè¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .slot-test {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #fafafa;
            min-height: 120px;
        }
        .slot-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .slot-image {
            width: 80px;
            height: 80px;
            border: 1px solid #ccc;
            border-radius: 4px;
            object-fit: cover;
        }
        
        /* è¤‡æ•°ç”»åƒã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .multi-image-container {
            display: flex;
            gap: 8px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            min-height: 60px;
            padding: 5px;
            border: 2px dashed #28a745;
            border-radius: 8px;
            background: #f8fff9;
        }
        
        .slot-multi-image {
            max-width: 50px;
            max-height: 50px;
            border: 2px solid #28a745;
            border-radius: 4px;
            object-fit: cover;
        }
        
        .slot-text {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            min-width: 200px;
        }
        .slot-phrase {
            font-size: 14px;
            color: #666;
        }
        .test-controls {
            margin: 20px 0;
            text-align: center;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .test-input {
            margin: 10px 0;
        }
        input[type="text"] {
            padding: 8px;
            width: 300px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .status {
            font-weight: bold;
            margin: 10px 0;
        }
        .success { color: #28a745; }
        .warning { color: #ffc107; }
        .error { color: #dc3545; }
        
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ–¼ï¸ è¤‡æ•°ç”»åƒè¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆ</h1>
        <p>ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã«å¿œã˜ã¦è¤‡æ•°ã®ç”»åƒã‚’è‡ªå‹•è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        
        <div class="status" id="system-status">ğŸ”„ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...</div>
        
        <div class="test-controls">
            <button onclick="testAllSlots()">ğŸ“Š å…¨ã‚¹ãƒ­ãƒƒãƒˆãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testMultipleImages()">ğŸ¯ è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆ</button>
            <button onclick="clearAllImages()">ğŸ—‘ï¸ ç”»åƒã‚¯ãƒªã‚¢</button>
            <button onclick="showDebugInfo()">ğŸ” ãƒ‡ãƒãƒƒã‚°æƒ…å ±</button>
        </div>
        
        <div class="test-input">
            <label>ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ:</label><br>
            <input type="text" id="custom-text" placeholder="ãƒ†ã‚¹ãƒˆç”¨ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ› (ä¾‹: committee responsible implementation)" />
            <button onclick="testCustomText()">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        </div>
    </div>

    <!-- è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆç”¨ã®ã‚¹ãƒ­ãƒƒãƒˆ -->
    <div class="test-container">
        <h2>ğŸ¯ è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆã‚¹ãƒ­ãƒƒãƒˆ</h2>
        
        <!-- O1ã‚¹ãƒ­ãƒƒãƒˆã®ãƒ†ã‚¹ãƒˆï¼ˆcommittee responsible implementationï¼‰ -->
        <div class="slot-test">
            <h3>O1ã‚¹ãƒ­ãƒƒãƒˆ: "the committee responsible for implementation"</h3>
            <div id="slot-o1" class="slot-container">
                <div class="slot-text">the committee responsible for implementation</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="o1 image" />
            </div>
        </div>
        
        <!-- ãã®ä»–ã®è¤‡æ•°å˜èªãƒ†ã‚¹ãƒˆ -->
        <div class="slot-test">
            <h3>M1ã‚¹ãƒ­ãƒƒãƒˆ: "early morning analysis"</h3>
            <div id="slot-m1" class="slot-container">
                <div class="slot-text">early morning analysis</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="m1 image" />
            </div>
        </div>
        
        <div class="slot-test">
            <h3>V ã‚¹ãƒ­ãƒƒãƒˆ: "make good decisions"</h3>
            <div id="slot-v" class="slot-container">
                <div class="slot-text">make good decisions</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="v image" />
            </div>
        </div>
        
        <div class="slot-test">
            <h3>C1ã‚¹ãƒ­ãƒƒãƒˆ: "the new fast car"</h3>
            <div id="slot-c1" class="slot-container">
                <div class="slot-text">the new fast car</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="c1 image" />
            </div>
        </div>
        
        <div class="slot-test">
            <h3>O2ã‚¹ãƒ­ãƒƒãƒˆ: "big small problems"</h3>
            <div id="slot-o2" class="slot-container">
                <div class="slot-text">big small problems</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="o2 image" />
            </div>
        </div>
    </div>

    <!-- å˜ä¸€ç”»åƒæ¯”è¼ƒç”¨ã®ã‚¹ãƒ­ãƒƒãƒˆ -->
    <div class="test-container">
        <h2>ğŸ” å˜ä¸€ç”»åƒæ¯”è¼ƒç”¨ã‚¹ãƒ­ãƒƒãƒˆ</h2>
        
        <div class="slot-test">
            <h3>S ã‚¹ãƒ­ãƒƒãƒˆ: "analysis" (å˜ä¸€ç”»åƒ)</h3>
            <div id="slot-s" class="slot-container">
                <div class="slot-text">analysis</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="s image" />
            </div>
        </div>
        
        <div class="slot-test">
            <h3>M2ã‚¹ãƒ­ãƒƒãƒˆ: "committee" (å˜ä¸€ç”»åƒ)</h3>
            <div id="slot-m2" class="slot-container">
                <div class="slot-text">committee</div>
                <img class="slot-image" src="slot_images/common/placeholder.png" alt="m2 image" />
            </div>
        </div>
    </div>

    <div class="debug-info" id="debug-output">
        ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
    </div>

    <script src="js/universal_image_system.js"></script>
    <script>
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“¦ è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸åˆæœŸåŒ–ä¸­...');
            
            // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚’å¾…ã¤
            setTimeout(() => {
                updateSystemStatus();
                logDebug('è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
            }, 1000);
        });

        // ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’æ›´æ–°
        function updateSystemStatus() {
            const statusEl = document.getElementById('system-status');
            
            if (window.imageMetaTags && window.imageMetaTags.length > 0) {
                statusEl.innerHTML = `âœ… ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº† (ãƒ¡ã‚¿ã‚¿ã‚°: ${window.imageMetaTags.length}ä»¶)`;
                statusEl.className = 'status success';
            } else {
                statusEl.innerHTML = 'âŒ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã«å¤±æ•—';
                statusEl.className = 'status error';
            }
        }

        // å…¨ã‚¹ãƒ­ãƒƒãƒˆã®ãƒ†ã‚¹ãƒˆ
        function testAllSlots() {
            logDebug('=== å…¨ã‚¹ãƒ­ãƒƒãƒˆãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            const slots = ['slot-o1', 'slot-m1', 'slot-v', 'slot-c1', 'slot-o2', 'slot-s', 'slot-m2'];
            
            slots.forEach(slotId => {
                logDebug(`ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ: ${slotId}`);
                if (window.updateSlotImage) {
                    window.updateSlotImage(slotId, true);
                } else {
                    logDebug(`ã‚¨ãƒ©ãƒ¼: updateSlotImageé–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
                }
            });
            
            logDebug('=== å…¨ã‚¹ãƒ­ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        // è¤‡æ•°ç”»åƒã®ç‰¹åˆ¥ãƒ†ã‚¹ãƒˆ
        function testMultipleImages() {
            logDebug('=== è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            // O1ã‚¹ãƒ­ãƒƒãƒˆã®è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆ
            const testText = 'the committee responsible for implementation';
            
            if (window.findAllImagesByMetaTag) {
                const matches = window.findAllImagesByMetaTag(testText);
                logDebug(`æ¤œç´¢çµæœ: ${testText} â†’ ${matches.length}å€‹ã®ç”»åƒ`);
                matches.forEach((match, index) => {
                    logDebug(`  ${index + 1}. ${match.image_file} (${match.description})`);
                });
            }
            
            if (window.applyMultipleImagesToSlot) {
                window.applyMultipleImagesToSlot('slot-o1', testText, true);
                logDebug('è¤‡æ•°ç”»åƒé©ç”¨å®Œäº†: slot-o1');
            }
            
            logDebug('=== è¤‡æ•°ç”»åƒãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        // ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆ
        function testCustomText() {
            const customText = document.getElementById('custom-text').value.trim();
            if (!customText) {
                alert('ãƒ†ã‚¹ãƒˆãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            logDebug(`=== ã‚«ã‚¹ã‚¿ãƒ ãƒ†ã‚¹ãƒˆ: "${customText}" ===`);
            
            if (window.findAllImagesByMetaTag) {
                const matches = window.findAllImagesByMetaTag(customText);
                logDebug(`æ¤œç´¢çµæœ: ${matches.length}å€‹ã®ç”»åƒ`);
                matches.forEach((match, index) => {
                    logDebug(`  ${index + 1}. ${match.image_file}`);
                });
                
                // O1ã‚¹ãƒ­ãƒƒãƒˆã«é©ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆ
                if (window.applyMultipleImagesToSlot) {
                    window.applyMultipleImagesToSlot('slot-o1', customText, true);
                }
            }
        }

        // å…¨ç”»åƒã‚’ã‚¯ãƒªã‚¢
        function clearAllImages() {
            logDebug('=== ç”»åƒã‚¯ãƒªã‚¢é–‹å§‹ ===');
            
            const images = document.querySelectorAll('.slot-image');
            const multiContainers = document.querySelectorAll('.multi-image-container');
            
            images.forEach(img => {
                img.src = 'slot_images/common/placeholder.png';
                img.style.display = 'block';
            });
            
            multiContainers.forEach(container => {
                container.remove();
            });
            
            logDebug('=== ç”»åƒã‚¯ãƒªã‚¢å®Œäº† ===');
        }

        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º
        function showDebugInfo() {
            logDebug('=== ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± ===');
            
            if (window.imageMetaTags) {
                logDebug(`ãƒ¡ã‚¿ã‚¿ã‚°ãƒ‡ãƒ¼ã‚¿: ${window.imageMetaTags.length}ä»¶èª­ã¿è¾¼ã¿æ¸ˆã¿`);
            } else {
                logDebug('ãƒ¡ã‚¿ã‚¿ã‚°ãƒ‡ãƒ¼ã‚¿: æœªèª­ã¿è¾¼ã¿');
            }
            
            logDebug(`åˆ©ç”¨å¯èƒ½ãªé–¢æ•°:`);
            logDebug(`  - updateSlotImage: ${typeof window.updateSlotImage}`);
            logDebug(`  - applyMultipleImagesToSlot: ${typeof window.applyMultipleImagesToSlot}`);
            logDebug(`  - findAllImagesByMetaTag: ${typeof window.findAllImagesByMetaTag}`);
            
            updateSystemStatus();
        }

        // ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°å‡ºåŠ›
        function logDebug(message) {
            const debugOutput = document.getElementById('debug-output');
            const timestamp = new Date().toLocaleTimeString();
            debugOutput.innerHTML += `[${timestamp}] ${message}\n`;
            debugOutput.scrollTop = debugOutput.scrollHeight;
            console.log(message);
        }
    </script>
</body>
</html>
