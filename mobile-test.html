<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>📱🔥 モバイル表示テスト v2.0 - 6個のサブスロット - Rephrase</title>
  <link href="training/style.css" rel="stylesheet"/>
  <link href="responsive.css" rel="stylesheet"/>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }
    
    .test-section {
      margin-bottom: 30px;
      border: 2px solid #ddd;
      padding: 15px;
      border-radius: 8px;
    }
    
    .test-title {
      background: #f0f0f0;
      margin: -15px -15px 15px -15px;
      padding: 10px 15px;
      font-weight: bold;
      border-radius: 6px 6px 0 0;
    }
    
    .device-info {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
    }
    
    .test-controls {
      position: fixed;
      bottom: 10px;
      left: 10px;
      right: 10px;
      background: rgba(255,255,255,0.95);
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    
    .test-controls button {
      margin: 2px;
      padding: 8px 12px;
      border: 1px solid #ccc;
      background: white;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .test-controls button:hover {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <div class="device-info" id="deviceInfo">
    画面: <span id="screenSize"></span><br>
    ブレークポイント: <span id="breakpoint"></span>
  </div>

  <h1>📱🔥 Rephrase モバイル表示テスト v2.0 (6個のサブスロット)</h1>
  
  <!-- Phase 1: 黄色タブテスト -->
  <div class="test-section">
    <div class="test-title">🎯 Phase 1: 黄色タブの幅問題テスト（10スロット分対応）</div>
    
    <!-- 上位スロット行のシミュレーション（10スロット + クリック可能） -->
    <div class="slot-wrapper" style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 10px; overflow-x: auto; white-space: nowrap;">
      <div class="slot-container clickable-slot" data-slot="m1" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">M1 📂</div>
        <div class="slot-text">This morning</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="s" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">S 📂</div>
        <div class="slot-text">I</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="aux" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">AUX 📂</div>
        <div class="slot-text">had</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="v" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">V 📂</div>
        <div class="slot-text">known</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="m2" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">M2 📂</div>
        <div class="slot-text">very well</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="o1" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">O1 📂</div>
        <div class="slot-text">that he</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="c1" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">C1 📂</div>
        <div class="slot-text">was</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="o2" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">O2 📂</div>
        <div class="slot-text">lying</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="c2" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">C2 📂</div>
        <div class="slot-text">to me</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
      
      <div class="slot-container clickable-slot" data-slot="m3" style="display: inline-block; background: rgba(254, 243, 199, 0.6); border: 2px solid #f59e0b; padding: 10px; margin: 5px; border-radius: 8px; min-width: 120px; vertical-align: top; white-space: normal; cursor: pointer;">
        <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">M3 📂</div>
        <div class="slot-text">from the start</div>
        <div style="font-size: 10px; color: #666; text-align: center; margin-top: 3px;">タップで展開</div>
      </div>
    </div>
    
    <!-- サブスロットエリア（動的に内容が変わる） -->
    <div id="subslot-display-area" class="slot-wrapper" style="background: #f0f8ff; padding: 10px; border-radius: 8px; margin-bottom: 10px; overflow-x: auto; white-space: nowrap; min-height: 80px; border: 2px dashed #ccc;">
      
      <!-- 初期状態の案内メッセージ -->
      <div id="subslot-message" style="text-align: center; color: #666; padding: 20px;">
        📂 上のスロットをタップして、サブスロットを表示してください
      </div>
      
    </div>
      
    </div>
  </div>

  <!-- Phase 2: タッチ操作テスト -->
  <div class="test-section">
    <div class="test-title">👆 Phase 2: タッチ操作テスト</div>
    
    <button style="margin: 5px;">通常ボタン</button>
    <button style="margin: 5px;">ボタン2</button>
    <button style="margin: 5px;">ボタン3</button>
    
    <div style="margin: 10px 0;">
      <input type="checkbox" id="test1"> <label for="test1">チェックボックス1</label><br>
      <input type="checkbox" id="test2"> <label for="test2">チェックボックス2</label><br>
      <input type="checkbox" id="test3"> <label for="test3">チェックボックス3</label>
    </div>
  </div>

  <!-- Phase 3: コンテンツ表示テスト -->
  <div class="test-section">
    <div class="test-title">📖 Phase 3: コンテンツ表示テスト</div>
    
    <div class="slot-container" style="background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 8px;">
      <div class="slot-text" style="font-size: 16px; line-height: 1.6;">
        This is a sample English sentence that might be quite long and needs proper wrapping on mobile devices.
      </div>
      <div class="slot-auxtext" style="font-size: 14px; color: #666; margin-top: 8px;">
        これは日本語の補助テキストです。モバイルでの読みやすさをテストしています。
      </div>
    </div>
  </div>

  <!-- ズームコントロールテスト -->
  <div class="test-section">
    <div class="test-title">🔍 ズームコントロールテスト</div>
    
    <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
      <label for="zoomSlider">ズーム:</label>
      <input type="range" id="zoomSlider" min="50" max="150" value="100" style="flex: 1; min-width: 150px;">
      <span id="zoomValue">100%</span>
      <button onclick="resetZoom()">リセット</button>
    </div>
  </div>

  <div class="test-controls">
    <button onclick="simulateDevice('iPhone SE')">iPhone SE (375px)</button>
    <button onclick="simulateDevice('iPhone 12')">iPhone 12 (390px)</button>
    <button onclick="simulateDevice('Android')">Android (360px)</button>
    <button onclick="simulateDevice('Tablet')">Tablet (768px)</button>
    <button onclick="simulateDevice('Desktop')">Desktop (1200px)</button>
    <button onclick="toggleOrientation()">画面回転</button>
  </div>

  <script>
    // デバイス情報表示
    function updateDeviceInfo() {
      const width = window.innerWidth;
      const height = window.innerHeight;
      
      document.getElementById('screenSize').textContent = `${width} × ${height}px`;
      
      let breakpoint = 'Desktop';
      if (width <= 480) breakpoint = 'Small Mobile';
      else if (width <= 768) breakpoint = 'Mobile';
      else if (width <= 1024) breakpoint = 'Tablet';
      
      document.getElementById('breakpoint').textContent = breakpoint;
    }
    
    // デバイス幅シミュレーション
    function simulateDevice(device) {
      const viewport = document.querySelector('meta[name="viewport"]');
      
      switch(device) {
        case 'iPhone SE':
          document.body.style.maxWidth = '375px';
          break;
        case 'iPhone 12':
          document.body.style.maxWidth = '390px';
          break;
        case 'Android':
          document.body.style.maxWidth = '360px';
          break;
        case 'Tablet':
          document.body.style.maxWidth = '768px';
          break;
        case 'Desktop':
          document.body.style.maxWidth = 'none';
          break;
      }
      
      document.body.style.margin = '0 auto';
      updateDeviceInfo();
    }
    
    // 画面回転シミュレーション
    function toggleOrientation() {
      const isLandscape = document.body.style.width === 'auto';
      if (isLandscape) {
        document.body.style.width = '';
        document.body.style.height = '';
      } else {
        const currentHeight = window.innerHeight;
        const currentWidth = window.innerWidth;
        document.body.style.width = currentHeight + 'px';
        document.body.style.height = currentWidth + 'px';
      }
    }
    
    // ズームコントロール
    function resetZoom() {
      document.getElementById('zoomSlider').value = 100;
      document.getElementById('zoomValue').textContent = '100%';
      document.body.style.transform = 'scale(1)';
    }
    
    document.getElementById('zoomSlider').addEventListener('input', function(e) {
      const value = e.target.value;
      document.getElementById('zoomValue').textContent = value + '%';
      document.body.style.transform = `scale(${value / 100})`;
      document.body.style.transformOrigin = 'top left';
    });
    
    // 初期化
    window.addEventListener('resize', updateDeviceInfo);
    updateDeviceInfo();
    
    // 開発者向けコンソールコマンド
    window.testMobile = {
      iPhone: () => simulateDevice('iPhone 12'),
      android: () => simulateDevice('Android'),
      tablet: () => simulateDevice('Tablet'),
      desktop: () => simulateDevice('Desktop'),
      rotate: toggleOrientation,
      resetZoom: resetZoom,
      
      // CSSデバッグ用
      highlightTabs: () => {
        document.querySelectorAll('.subslot-label.tab-style').forEach(el => {
          el.style.border = '3px solid red';
          el.style.background = 'rgba(255,0,0,0.3)';
        });
      },
      
      resetHighlight: () => {
        document.querySelectorAll('.subslot-label.tab-style').forEach(el => {
          el.style.border = '';
          el.style.background = '';
        });
      }
    };
    
    // 🎯 サブスロット展開システム
    const subslotSystem = {
      // サブスロットのデモデータ（実際のアプリではDBから取得）
      subslotData: {
        m1: {
          label: 'M1 Modifier Details (This morning の詳細)',
          subslots: [
            { label: 'SUB-S', text: 'this', auxtext: 'この' },
            { label: 'SUB-AUX', text: 'morning', auxtext: '朝' },
            { label: 'SUB-V', text: 'early', auxtext: '早い' },
            { label: 'SUB-O', text: 'today', auxtext: '今日' },
            { label: 'SUB-C', text: 'time', auxtext: '時間' },
            { label: 'SUB-M', text: 'around 7am', auxtext: '朝7時頃' }
          ]
        },
        s: {
          label: 'S Subject Details (I の詳細)',
          subslots: [
            { label: 'SUB-PERSON', text: 'myself', auxtext: '私自身' },
            { label: 'SUB-PRONOUN', text: 'I', auxtext: '私' },
            { label: 'SUB-TYPE', text: 'first person', auxtext: '一人称' }
          ]
        },
        v: {
          label: 'V Verb Details (known の詳細)',
          subslots: [
            { label: 'SUB-BASE', text: 'know', auxtext: '知る' },
            { label: 'SUB-FORM', text: 'past participle', auxtext: '過去分詞' },
            { label: 'SUB-MEANING', text: 'understand', auxtext: '理解する' },
            { label: 'SUB-TENSE', text: 'perfect', auxtext: '完了形' }
          ]
        },
        o1: {
          label: 'O1 Object Details (that he の詳細)',
          subslots: [
            { label: 'SUB-THAT', text: 'that', auxtext: 'あれ' },
            { label: 'SUB-HE', text: 'he', auxtext: '彼' },
            { label: 'SUB-CLAUSE', text: 'noun clause', auxtext: '名詞節' }
          ]
        },
        aux: {
          label: 'AUX Auxiliary Details (had の詳細)',
          subslots: [
            { label: 'SUB-HAVE', text: 'have', auxtext: '持つ' },
            { label: 'SUB-PAST', text: 'past form', auxtext: '過去形' },
            { label: 'SUB-PERFECT', text: 'perfect auxiliary', auxtext: '完了の助動詞' }
          ]
        },
        m2: {
          label: 'M2 Modifier Details (very well の詳細)',
          subslots: [
            { label: 'SUB-VERY', text: 'very', auxtext: 'とても' },
            { label: 'SUB-WELL', text: 'well', auxtext: 'よく' },
            { label: 'SUB-DEGREE', text: 'adverb of degree', auxtext: '程度の副詞' }
          ]
        },
        c1: {
          label: 'C1 Complement Details (was の詳細)',
          subslots: [
            { label: 'SUB-BE', text: 'be', auxtext: 'である' },
            { label: 'SUB-PAST', text: 'was', auxtext: 'だった' },
            { label: 'SUB-STATE', text: 'state of being', auxtext: '存在の状態' }
          ]
        },
        o2: {
          label: 'O2 Object Details (lying の詳細)',
          subslots: [
            { label: 'SUB-LIE', text: 'lie', auxtext: '嘘をつく' },
            { label: 'SUB-ING', text: 'progressive', auxtext: '進行形' },
            { label: 'SUB-ACTION', text: 'ongoing action', auxtext: '継続的行為' }
          ]
        },
        c2: {
          label: 'C2 Complement Details (to me の詳細)',
          subslots: [
            { label: 'SUB-TO', text: 'to', auxtext: 'に向かって' },
            { label: 'SUB-ME', text: 'me', auxtext: '私に' },
            { label: 'SUB-PREP', text: 'prepositional phrase', auxtext: '前置詞句' }
          ]
        },
        m3: {
          label: 'M3 Modifier Details (from the start の詳細)',
          subslots: [
            { label: 'SUB-FROM', text: 'from', auxtext: 'から' },
            { label: 'SUB-THE', text: 'the', auxtext: 'その' },
            { label: 'SUB-START', text: 'start', auxtext: '始まり' },
            { label: 'SUB-TIME', text: 'time reference', auxtext: '時間の参照' }
          ]
        }
      },
      
      currentSlot: null,
      
      // サブスロット表示
      showSubslots: function(slotId) {
        console.log(`📂 ${slotId} のサブスロットを表示`);
        
        const data = this.subslotData[slotId];
        if (!data) {
          console.warn(`⚠ ${slotId} のサブスロットデータが見つかりません`);
          return;
        }
        
        this.currentSlot = slotId;
        
        // サブスロットエリアを取得
        const subslotArea = document.getElementById('subslot-display-area');
        const messageDiv = document.getElementById('subslot-message');
        
        if (!subslotArea) return;
        
        // メッセージを非表示
        if (messageDiv) {
          messageDiv.style.display = 'none';
        }
        
        // 現在のサブスロットをクリア
        this.clearSubslots();
        
        // 選択されたスロットをハイライト
        this.highlightSelectedSlot(slotId);
        
        // 新しいサブスロットを作成
        this.createSubslotContent(subslotArea, data);
        
        // スクロール位置を調整
        setTimeout(() => {
          subslotArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
      },
      
      // サブスロットコンテンツ作成
      createSubslotContent: function(container, data) {
        // ラベル作成
        const label = document.createElement('div');
        label.className = 'subslot-label';
        label.style.cssText = `
          display: block; 
          width: 100%; 
          margin-bottom: 10px; 
          white-space: normal;
          background: rgba(255, 193, 7, 0.2);
          border: 2px solid #ffc107;
          padding: 8px 12px;
          border-radius: 6px;
          font-weight: bold;
          color: #856404;
        `;
        label.innerHTML = `📂 ${data.label}`;
        container.appendChild(label);
        
        // サブスロット作成
        data.subslots.forEach(subslot => {
          const slotDiv = document.createElement('div');
          slotDiv.className = 'slot-container';
          slotDiv.style.cssText = `
            display: inline-block; 
            background: rgba(254, 243, 199, 0.6); 
            border: 2px solid #f59e0b; 
            padding: 10px; 
            margin: 5px; 
            border-radius: 8px; 
            min-width: 120px; 
            vertical-align: top; 
            white-space: normal;
            transition: transform 0.2s ease;
          `;
          
          slotDiv.innerHTML = `
            <div style="font-weight: bold; text-align: center; margin-bottom: 5px;">${subslot.label}</div>
            <div class="slot-text" style="text-align: center; margin-bottom: 3px;">${subslot.text}</div>
            <div class="slot-auxtext" style="font-size: 12px; color: #666; text-align: center;">${subslot.auxtext}</div>
          `;
          
          // ホバー効果
          slotDiv.addEventListener('mouseenter', () => {
            slotDiv.style.transform = 'scale(1.05)';
          });
          slotDiv.addEventListener('mouseleave', () => {
            slotDiv.style.transform = 'scale(1)';
          });
          
          container.appendChild(slotDiv);
        });
      },
      
      // 選択されたスロットをハイライト
      highlightSelectedSlot: function(slotId) {
        // 全スロットのハイライトを削除
        document.querySelectorAll('.clickable-slot').forEach(slot => {
          slot.style.background = 'rgba(254, 243, 199, 0.6)';
          slot.style.border = '2px solid #f59e0b';
        });
        
        // 選択されたスロットをハイライト
        const selectedSlot = document.querySelector(`[data-slot="${slotId}"]`);
        if (selectedSlot) {
          selectedSlot.style.background = 'rgba(255, 193, 7, 0.8)';
          selectedSlot.style.border = '3px solid #ffc107';
        }
      },
      
      // サブスロットをクリア
      clearSubslots: function() {
        const subslotArea = document.getElementById('subslot-display-area');
        if (subslotArea) {
          // ラベルとメッセージ以外のコンテンツを削除
          const children = Array.from(subslotArea.children);
          children.forEach(child => {
            if (!child.id || child.id !== 'subslot-message') {
              subslotArea.removeChild(child);
            }
          });
        }
      },
      
      // サブスロットを閉じる
      closeSubslots: function() {
        console.log('❌ サブスロットを閉じます');
        
        const subslotArea = document.getElementById('subslot-display-area');
        const messageDiv = document.getElementById('subslot-message');
        
        // サブスロットをクリア
        this.clearSubslots();
        
        // メッセージを表示
        if (messageDiv) {
          messageDiv.style.display = 'block';
        }
        
        // ハイライトを削除
        document.querySelectorAll('.clickable-slot').forEach(slot => {
          slot.style.background = 'rgba(254, 243, 199, 0.6)';
          slot.style.border = '2px solid #f59e0b';
        });
        
        this.currentSlot = null;
      },
      
      // 初期化
      init: function() {
        console.log('🎯 サブスロット展開システムを初期化');
        
        // クリックイベントを設定
        document.querySelectorAll('.clickable-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            const slotId = slot.getAttribute('data-slot');
            console.log(`👆 ${slotId} スロットがクリックされました`);
            
            // 現在のスロットと同じ場合は閉じる、違う場合は新しく開く
            if (this.currentSlot === slotId) {
              this.closeSubslots();
            } else {
              this.showSubslots(slotId);
            }
          });
        });
        
        console.log('✅ サブスロット展開システム初期化完了');
      }
    };
    
    console.log('📱 モバイルテストコマンド:');
    console.log('- testMobile.iPhone() : iPhone表示');
    console.log('- testMobile.android() : Android表示');
    console.log('- testMobile.tablet() : タブレット表示');
    console.log('- testMobile.desktop() : デスクトップ表示');
    console.log('- testMobile.rotate() : 画面回転');
    console.log('- testMobile.highlightTabs() : タブのハイライト');
    console.log('- testMobile.resetHighlight() : ハイライト解除');
  </script>
</body>
</html>
