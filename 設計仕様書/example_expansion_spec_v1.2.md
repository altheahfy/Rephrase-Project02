# Rephraseプロジェクト例文増殖設計仕様書（v1.2）

作成日: 2025-06-21  
作成者: ChatGPT（Rephraseプロジェクト参謀本部）  
用途: ChatGPT に例文増殖を依頼する際の標準仕様ガイド  

---

## 🎯 **目的**

ランダマイズシステムの母集団となる例文セットを作成する際、各スロットの文法的・意味的整合性を保つ。  
既存例文の構造を維持しながら、語彙パラフレーズによる選択肢を増やし、ランダマイズ後も文が自然に成立することを保証する。  
ChatGPT が例文セット増殖を依頼された際、この仕様書を準拠ルールとして参照する。

---

## 📝 **スロット構造と属性仕様**

各例文は以下の標準スロットで構成する。各スロットには属性タグを必ず付与する。

| スロット | 内容例 | 必須属性 | 補足 |
|-----------|---------|----------|-------|
| M1 | That afternoon at the crucial point | time_place | 必ず具体的時刻・場所の情報 |
| S | the manager who had recently taken charge | number, gender, animacy | 主語の数（singular/plural）、性（male/female/neutral）、有生性 |
| Aux | had to make | - | 固定（ランダマイズ対象外） |
| V | make | - | 固定（ランダマイズ対象外） |
| O1 | the committee responsible for implementation | number, type | 数、集団/個人など |
| O2 | deliver the final proposal flawlessly | compatibleO1Type | 対応可能なO1のtype（group/individual/both） |
| M2 | even though he was under intense pressure | pronoun_owner | 所有者（主語に紐づく代名詞） |
| C1 | because he feared upsetting her | pronoun_owner | 同上 |
| C2 | - | - | 必要に応じて |
| M3 | so the outcome would reflect their full potential | result_owner | 所有者（O1等に紐づく結果） |

### **🔤 QuestionType（疑問語分類）属性**

| 属性値 | 説明 | 対象スロット | 例 |
|--------|-------|-------------|-----|
| wh-word | 疑問語（What, Where, When等） | M1, M2, M3, O2等 | What, Where, When, How |
| - | 疑問語以外（空白または未記載） | 全スロット | 通常の文要素 |

**🚨 重要な制約**: ランダマイズ時、`QuestionType: wh-word`の要素は文中に1つまでしか選択されません。これにより「What」と「Where」が同時に現れる等の文法的に不自然な組み合わせを防止します。

---

## 🧩 **ランダマイズ設計ルール**

1️⃣ **ランダマイズ対象スロット**
- M1, S, O1, O2, M2, C1, M3, C2
- Aux, V は固定

2️⃣ **組み合わせ整合ルール**
- O1 の type と O2 の compatibleO1Type が一致する必要がある。
- S の number / gender に基づいて M2, C1 の代名詞（he/his/they/their 等）を補正。
- O1 の number/type に基づいて M3 の所有代名詞を補正。
- **🔤 QuestionType制約**: `QuestionType: wh-word`の要素は文中に1つまでしか選択されない（疑問語重複防止）。

3️⃣ **疑問語競合防止処理**
- ランダマイズ前に全スロット候補から `QuestionType: wh-word` を含む要素を事前抽出。
- 疑問語候補が存在する場合、その中から1つのみを選択し、他の疑問語要素を除外。
- 疑問語以外の通常要素は除外対象から外して通常通りランダマイズ。
- これにより「What do you think Where is it?」等の文法的に破綻した文の生成を防止。

3️⃣ **補正後処理**
- ランダマイズ後に各スロット属性を確認し、代名詞・所有格を動的補正する。
- 疑問語競合チェック: 選択されたスロット群に `QuestionType: wh-word` が2つ以上含まれる場合は再選択。
- 補正例:
  - S: singular male → M2/C1: he / his
  - S: singular female → M2/C1: she / her
  - S: plural → M2/C1: they / their
  - O1: group → M3: their
  - O1: singular neutral → M3: its

4️⃣ **性（gender）補正ルール**
- 主語（S）は必ず gender 属性を持ち、ランダマイズ後の M2, C1 の代名詞・所有格は S の gender 属性に基づいて補正すること。
- 代名詞補正が困難または曖昧な場合、代名詞の代わりに S のフル表現を使用して文の一貫性を保つことも許容する。

---

## 📌 **例文増殖の基本原則**

💡 **構造維持原則**
- **スロット構成は完全固定**: 元例文にあるスロットのみ増殖対象。M1が無い文にM1を追加したり、既存スロットを削除することは禁止。
- **Aux・V完全固定**: 助動詞・動詞は一切変更しない。時制・語法・文型を維持。
- **品詞カテゴリ固定**: 各スロットの品詞カテゴリ（名詞句・副詞句・形容詞等）は維持。

💡 **パラフレーズ原則**
- **語彙レベルでのパラフレーズのみ**: 単語・表現を類義語に置き換える。
- **文法的整合性の維持**: 主語の人称・性・数に基づく動詞活用、代名詞の一致を厳守。
- **意味的自然性の保持**: パラフレーズ後も文全体が自然で論理的に成立。

💡 **ランダマイズ対応設計**
- **属性タグ必須**: 全スロットに文法属性（number, gender, animacy等）を付与。
- **疑問語制御**: QuestionType属性により疑問語の重複を防止。
- **整合性ルール**: S-M2-C1の代名詞整合、O1-O2のtype整合等を属性で管理。

---

## 🌱 **例文増殖プロセス**

1️⃣ **構造分析**: 元例文のスロット構成を完全把握（追加・削除禁止）。  
2️⃣ **固定要素確認**: Aux・Vを固定要素として特定。  
3️⃣ **パラフレーズ対象特定**: S, O1, M1, M2, M3, C1等の変更可能スロット特定。  
4️⃣ **属性定義**: 各スロットに文法属性付与（QuestionType属性含む）。  
5️⃣ **整合性チェック**: S-代名詞、O1-O2type等の整合ルール確認。  
6️⃣ **語彙パラフレーズ**: 類義語・同義表現での置き換え実行。  
7️⃣ **文法検証**: パラフレーズ後の文法的正確性確認。  
8️⃣ **絶対順序出力**: M1-1, S-2, Aux-3, V-4...の固定順序で出力。

### 🚨 **増殖時の禁止事項**
- ❌ スロット構成の変更（追加・削除・順序変更）
- ❌ Aux・Vの変更
- ❌ 品詞カテゴリの変更
- ❌ 文型・時制の変更
- ❌ 主語と動詞の不一致を生む変更

---

## ⚠ **留意点**

- **構造固定**: スロット構成・品詞カテゴリ・Aux/Vは絶対に変更しない。
- **属性記載必須**: スロット属性の記載漏れ防止（特にQuestionType属性）。
- **文法整合性**: 主語-動詞-代名詞の一致、O1-O2のtype整合を厳守。
- **疑問語制御**: QuestionType属性により「What + Where」等の重複を自動排除。
- **パラフレーズ限定**: 語彙レベルの置き換えのみ。文構造は不変。
- **ランダマイズ前提**: 生成された選択肢群がランダム組み合わせ可能になるよう設計。

---

## 💾 **ChatGPTに依頼する際の指示例**

```
この仕様書に基づき、構文5001用の例文増殖をお願いします。
例示文のスロット構造・文法要点を保持してください。
属性整合の取れた例文を5セット生成してください。
出力形式：JSON または表形式
```

---

## 🛠 **拡張予定（次バージョンで追加）**
- スロット属性リストの詳細例（Excel/JSON）
- 属性間整合マトリクス
- 補正アルゴリズムの疑似コード

---

## 🔑 **保存用備考**
この仕様書を ChatGPT にアップロードし、例文増殖依頼時の基準ファイルとする。
ファイル名推奨：`example_expansion_spec_v1.2.md`

---

## 🤖 **ML Model 活用方針（2025年7月11日更新）**

### 📊 **現状分析結果**
- **スロット分解**: 複雑な文脈依存性とルール例外が多く、ML modelは適さない
- **現在のアプローチ**: 手動ルールベース（slottext.json）が適切で効果的
- **既存ML実装**: ml_model_from_excel.py は構造予測用で、実際には使用されていない

### 🎯 **段階的活用戦略**
```
フェーズ1（現在）: 手動ルール充実
├── slottext.json の体系化・例外ケース対応
├── 階層化ルール導入
└── 例文セット作成継続

フェーズ2（データ蓄積中期）: 
├── 例文データ蓄積（目標：1000-5000例文）
├── パターン分析・ルール効果測定
└── 自動パターン発見の準備

フェーズ3（ML活用期）:
├── ml_model_from_excel.py をslottext.json作成用に改造
├── 蓄積データでの学習（補助テキスト生成特化）
└── 既存ルールとML予測の融合システム
```

### 💡 **将来的なML活用方針**
- **目的**: スロット分解ではなく、補助テキスト生成の自動化
- **学習データ**: 蓄積された例文セットと対応する補助テキスト
- **手法**: 文脈を考慮した分類・生成モデル
- **統合**: 既存slottext.jsonルールとML予測の併用
