/* =================================================================== */
/* 📱 Rephrase モバイル最適化CSS - Phase 1: 基本表示安定化             */
/* =================================================================== */
/* 注意: このCSSは既存のstyle.cssよりも後に読み込まれるため優先されます    */

/* 🎯 Phase 1: 黄色タブの幅問題修正（10スロット分固定幅対応） */
@media (max-width: 768px) {
  /* 黄色タブラベルの幅問題修正 - 10スロット分の幅を確保 */
  .subslot-label.tab-style {
    margin-left: -20px !important;  /* 元の値に戻す（PC同様） */
    margin-right: -20px !important; /* 元の値に戻す（PC同様） */
    width: calc(100% + 40px) !important; /* 10スロット分の幅を確保 */
    min-width: calc(100vw - 20px) !important; /* 画面幅いっぱいまで使用 */
    max-width: none !important; /* 最大幅制限を解除 */
    box-sizing: border-box !important;
    overflow: visible !important; /* はみ出しを許可（横スクロール対応） */
    word-wrap: break-word !important; /* 長いテキストの改行 */
    position: relative !important; /* 既存スタイル保持 */
    white-space: nowrap !important; /* テキストの改行防止 */
  }

  /* サブスロットエリアの適切なサイズ確保 - 縮小問題解決 */
  .slot-wrapper.active-subslot-area {
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100% !important; /* max-widthから変更 */
    min-width: 100% !important; /* 最小幅確保 */
    overflow-x: auto !important; /* 横スクロール可能に変更 */
    box-sizing: border-box !important; /* ボーダーボックス適用 */
    padding: 15px !important; /* 適切なパディング確保 */
  }

  /* 親スロットのタブ連結調整 - 10スロット分対応 */
  .slot-container.active-parent-slot {
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100% !important; /* max-widthから変更 */
    min-width: 100% !important; /* 最小幅確保 */
    box-sizing: border-box !important; /* ボーダーボックス適用 */
    overflow-x: auto !important; /* 横スクロール可能 */
  }

  /* サブスロット内のスロットコンテナ - 適切なサイズ確保 */
  .slot-wrapper.active-subslot-area .slot-container {
    width: auto !important; /* 自動幅調整 */
    min-width: 150px !important; /* 最小幅確保（1スロット分） */
    margin-bottom: 10px !important;
    flex-shrink: 0 !important; /* 縮小防止 */
  }

  /* メインのスロットエリア全体 - 横スクロール対応 */
  body {
    overflow-x: auto !important; /* 横スクロール許可 */
    min-width: 100vw !important; /* ビューポート幅確保 */
  }

  /* 基本的なコンテナ - 10スロット表示対応 */
  .slot-container {
    min-width: 120px !important; /* 各スロットの最小幅確保 */
    box-sizing: border-box !important;
    flex-shrink: 0 !important; /* 縮小防止 */
  }

  /* 上位スロット行の横スクロール対応 */
  .slot-wrapper:not(.active-subslot-area) {
    overflow-x: auto !important; /* 横スクロール可能 */
    white-space: nowrap !important; /* 改行防止 */
    padding-bottom: 10px !important; /* スクロールバー用の余白 */
  }

  /* 上位スロット行のスロットをインライン表示 */
  .slot-wrapper:not(.active-subslot-area) .slot-container {
    display: inline-block !important;
    vertical-align: top !important;
    white-space: normal !important; /* テキスト内は改行許可 */
    margin-right: 10px !important; /* スロット間の余白 */
  }

  /* 制御パネルのモバイル対応 */
  .control-panel {
    padding: 8px !important;
    margin: 5px 0 !important;
    overflow-x: auto !important; /* 横スクロール可能 */
    white-space: nowrap !important; /* ボタンの改行防止 */
  }

  /* 全体ランダマイズボタンの調整 */
  #randomize-all {
    width: 100% !important;
    max-width: none !important;
    margin-bottom: 10px !important;
  }
}

/* =================================================================== */
/* 📱 Phase 2: タッチ操作最適化（準備）                               */
/* =================================================================== */

@media (max-width: 768px) {
  /* ボタンサイズの適正化 */
  button, .btn {
    min-height: 44px !important; /* Apple推奨のタッチターゲットサイズ */
    min-width: 44px !important;
    padding: 12px 16px !important;
    font-size: 16px !important; /* ズーム防止 */
  }

  /* タッチターゲット間隔調整 */
  .control-panel button {
    margin: 4px !important;
  }

  /* チェックボックスのタッチ領域拡大 */
  input[type="checkbox"] {
    width: 20px !important;
    height: 20px !important;
    margin: 8px !important;
  }
}

/* =================================================================== */
/* 📱 Phase 3: UX改善（準備）                                         */
/* =================================================================== */

@media (max-width: 768px) {
  /* 縦画面専用レイアウト調整 */
  .slot-container {
    margin-bottom: 10px !important;
    padding: 10px !important;
  }

  /* 長いコンテンツの分割表示準備 */
  .slot-text, .slot-auxtext {
    line-height: 1.6 !important;
    font-size: 16px !important; /* 読みやすさ向上 */
  }

  /* アコーディオン式ナビゲーション準備 */
  .control-panel {
    position: sticky !important;
    top: 0 !important;
    z-index: 100 !important;
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(10px) !important;
  }
}

/* =================================================================== */
/* 📱 タブレット対応                                                  */
/* =================================================================== */

@media (min-width: 769px) and (max-width: 1024px) {
  /* タブレット専用の調整 */
  .subslot-label.tab-style {
    margin-left: -15px !important;
    margin-right: -15px !important;
    width: calc(100% + 30px) !important;
  }

  button, .btn {
    min-height: 40px !important;
    min-width: 40px !important;
  }
}

/* =================================================================== */
/* 📱 スマートフォン小型画面対応                                       */
/* =================================================================== */

@media (max-width: 480px) {
  /* より小さい画面での追加調整 */
  .subslot-label.tab-style {
    font-size: 12px !important;
    padding: 6px 12px !important;
  }

  .slot-container {
    padding: 8px !important;
    margin-bottom: 8px !important;
  }

  /* テキストサイズ調整 */
  .slot-text, .slot-auxtext {
    font-size: 14px !important;
  }

  /* ズームコントロールのサイズ調整 */
  #zoomSlider {
    width: 100% !important;
    max-width: 200px !important;
  }
}

/* =================================================================== */
/* 📱 縦画面（ポートレート）専用対応                                   */
/* =================================================================== */

@media (max-width: 768px) and (orientation: portrait) {
  /* 縦画面での黄色タブ調整 */
  .subslot-label.tab-style {
    min-width: calc(100vw - 10px) !important; /* 縦画面では画面幅いっぱい */
    font-size: 13px !important; /* 縦画面では少し小さめのフォント */
  }

  /* 縦画面でのサブスロットエリア最適化 */
  .slot-wrapper.active-subslot-area {
    min-height: auto !important; /* 高さの自動調整 */
    padding: 10px !important; /* パディング調整 */
  }

  /* 縦画面でのスロット表示 - グリッドレイアウト */
  .slot-wrapper.active-subslot-area .slot-container {
    width: calc(50% - 5px) !important; /* 2列表示 */
    display: inline-block !important;
    vertical-align: top !important;
    margin: 5px !important;
  }
}

/* =================================================================== */
/* 📱 横画面対応                                                      */
/* =================================================================== */

@media (max-width: 768px) and (orientation: landscape) {
  /* 横画面での特別な調整 */
  .control-panel {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    top: auto !important;
    padding: 8px !important;
  }

  /* メインコンテンツの下部余白確保 */
  body {
    padding-bottom: 80px !important;
  }
}

/* =================================================================== */
/* 📱 アクセシビリティ改善                                            */
/* =================================================================== */

@media (max-width: 768px) {
  /* 高コントラスト対応 */
  @media (prefers-contrast: high) {
    .subslot-label.tab-style {
      border: 2px solid #000 !important;
      color: #000 !important;
    }
  }

  /* 動きの軽減 */
  @media (prefers-reduced-motion: reduce) {
    .slot-container.active-parent-slot,
    .slot-wrapper.active-subslot-area {
      animation: none !important;
      transition: none !important;
    }
  }

  /* フォーカス表示の改善 */
  button:focus, 
  input:focus,
  .btn:focus {
    outline: 3px solid #007AFF !important;
    outline-offset: 2px !important;
  }
}

/* =================================================================== */
/* 📱 デバッグ用スタイル（開発時のみ使用）                           */
/* =================================================================== */

/* デバッグ時にコメントアウトを外して使用 */
/*
@media (max-width: 768px) {
  * {
    border: 1px solid red !important;
  }
  
  .subslot-label.tab-style {
    background: rgba(255, 0, 0, 0.3) !important;
  }
}
*/
