
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Rephrase Structured UI</title>
  <link href="style.css" rel="stylesheet"/>
</head>
<body>
  <section>
    <label for="fileInput">grammar_data0001.xlsx を選択：</label>
    <input accept=".xlsx" id="fileInput" type="file"/>
    <button id="loadButton">📘 Load</button>
  </section>
  <script type="module">
    let currentFile = null;
    document.getElementById("fileInput").addEventListener("change", (event) => {
      currentFile = event.target.files[0];
    });
    document.getElementById("loadButton").addEventListener("click", () => {
      if (!currentFile) {
        alert("先に grammar_data0001.xlsx を選んでください。");
        return;
      }
      import("./js/randomizer_controller.js").then(module => {
        module.handleExcelFileUpload(currentFile).then(() => {
          import("./js/structure_builder.js").then(builderModule => {
            if (window.lastSlotData) {
              builderModule.buildStructureFromJson(window.lastSlotData);
            } else {
              console.warn("順序制御のデータが未セットです");
            }
          });
        });
      });
    });
  </script>
</body>
</html>
