<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rephrase - ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    
    <!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #ff6b35;
        }

        .severity-stats {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .severity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .severity-item:last-child {
            border-bottom: none;
        }

        .severity-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .severity-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .severity-critical { background: #d32f2f; }
        .severity-high { background: #f57c00; }
        .severity-medium { background: #1976d2; }
        .severity-low { background: #388e3c; }

        .error-log {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .log-filters {
            display: flex;
            gap: 10px;
        }

        .filter-select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .log-entry {
            border: 1px solid #eee;
            border-radius: 5px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .log-entry-header {
            background: #f8f9fa;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .log-entry-header:hover {
            background: #e9ecef;
        }

        .log-entry-content {
            padding: 15px;
            display: none;
            border-top: 1px solid #eee;
            background: #fafafa;
        }

        .log-entry.expanded .log-entry-content {
            display: block;
        }

        .log-meta {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #666;
        }

        .log-message {
            font-weight: bold;
            color: #333;
        }

        .log-details {
            margin-top: 10px;
        }

        .log-detail-item {
            margin-bottom: 8px;
        }

        .log-detail-label {
            font-weight: bold;
            color: #555;
            display: inline-block;
            width: 100px;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
            transition: background-color 0.3s ease;
        }

        .btn-primary {
            background: #ff6b35;
            color: white;
        }

        .btn-primary:hover {
            background: #e55a2b;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .refresh-info {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }

        .no-errors {
            text-align: center;
            color: #666;
            padding: 40px;
            font-size: 16px;
        }

        .error-chart {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .chart-container {
            height: 200px;
            display: flex;
            align-items: end;
            justify-content: space-around;
            border-bottom: 2px solid #eee;
            padding: 10px 0;
        }

        .chart-bar {
            width: 40px;
            background: linear-gradient(to top, #ff6b35, #f7931e);
            border-radius: 3px 3px 0 0;
            position: relative;
        }

        .chart-label {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .export-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âš ï¸ ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
            <p>ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®ç›£è¦–ãƒ»åˆ†æ</p>
        </div>

        <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>ğŸ“Š ç·ã‚¨ãƒ©ãƒ¼æ•°</h3>
                <div class="stat-value" id="total-errors">0</div>
            </div>
            <div class="stat-card">
                <h3>ğŸš¨ é‡è¦ã‚¨ãƒ©ãƒ¼</h3>
                <div class="stat-value" id="critical-errors">0</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ“ˆ ä»Šæ—¥ã®ã‚¨ãƒ©ãƒ¼</h3>
                <div class="stat-value" id="today-errors">0</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ›¡ï¸ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹</h3>
                <div class="stat-value" id="system-health" style="font-size: 18px;">è‰¯å¥½</div>
            </div>
        </div>

        <!-- é‡è¦åº¦åˆ¥çµ±è¨ˆ -->
        <div class="severity-stats">
            <h3>ğŸ¯ é‡è¦åº¦åˆ¥ã‚¨ãƒ©ãƒ¼</h3>
            <div id="severity-breakdown">
                <!-- å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ -->
        <div class="error-chart">
            <h3>ğŸ“ˆ æ™‚ç³»åˆ—ã‚¨ãƒ©ãƒ¼åˆ†æ</h3>
            <div class="chart-container" id="error-chart">
                <!-- å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>

        <!-- åˆ¶å¾¡ãƒ‘ãƒãƒ« -->
        <div class="controls">
            <h3>ğŸ›ï¸ åˆ¶å¾¡ãƒ‘ãƒãƒ«</h3>
            <button class="btn btn-primary" onclick="refreshDashboard()">ğŸ”„ æ›´æ–°</button>
            <button class="btn btn-secondary" onclick="testError()">âš¡ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼</button>
            <button class="btn btn-danger" onclick="clearErrorLog()">ğŸ—‘ï¸ ãƒ­ã‚°ã‚¯ãƒªã‚¢</button>
            <button class="btn btn-secondary" onclick="exportLog()">ğŸ’¾ ãƒ­ã‚°å‡ºåŠ›</button>
            
            <div class="auto-refresh">
                <label>
                    <input type="checkbox" id="auto-refresh" checked> è‡ªå‹•æ›´æ–°ï¼ˆ10ç§’é–“éš”ï¼‰
                </label>
            </div>
        </div>

        <!-- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° -->
        <div class="error-log">
            <div class="log-header">
                <h3>ğŸ“ ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°</h3>
                <div class="log-filters">
                    <select class="filter-select" id="severity-filter">
                        <option value="">å…¨é‡è¦åº¦</option>
                        <option value="critical">é‡è¦</option>
                        <option value="high">é«˜</option>
                        <option value="medium">ä¸­</option>
                        <option value="low">ä½</option>
                    </select>
                    <select class="filter-select" id="type-filter">
                        <option value="">å…¨ã‚¿ã‚¤ãƒ—</option>
                        <option value="javascript">JavaScript</option>
                        <option value="promise">Promise</option>
                        <option value="application">Application</option>
                        <option value="console">Console</option>
                    </select>
                </div>
            </div>
            <div id="error-log-content">
                <!-- å‹•çš„ç”Ÿæˆ -->
            </div>
        </div>

        <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="export-section">
            <h3>ğŸ“¤ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h3>
            <p>ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’JSONå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã¾ã™ã€‚ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰</p>
            <button class="btn btn-secondary" onclick="exportFullLog()">ğŸ“‹ å®Œå…¨ãƒ­ã‚°å‡ºåŠ›</button>
            <button class="btn btn-secondary" onclick="exportStats()">ğŸ“Š çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å‡ºåŠ›</button>
        </div>

        <div class="refresh-info">
            <p>â±ï¸ æœ€çµ‚æ›´æ–°: <span id="last-update">--</span></p>
        </div>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="error-detail-modal" class="modal">
        <div class="modal-content">
            <h3>ğŸ” ã‚¨ãƒ©ãƒ¼è©³ç´°</h3>
            <div id="modal-content">
                <!-- å‹•çš„ç”Ÿæˆ -->
            </div>
            <button class="btn btn-primary" onclick="closeModal()">é–‰ã˜ã‚‹</button>
        </div>
    </div>

    <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ èª­ã¿è¾¼ã¿ -->
    <script src="./js/error-handler.js"></script>
    
    <script>
        let updateInterval;
        let filteredErrors = [];

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initDashboard();
            setupFilters();
            startAutoUpdate();
        });

        function initDashboard() {
            console.log('ğŸ“Š ã‚¨ãƒ©ãƒ¼ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–');
            refreshDashboard();
        }

        function setupFilters() {
            const severityFilter = document.getElementById('severity-filter');
            const typeFilter = document.getElementById('type-filter');

            severityFilter.addEventListener('change', filterErrors);
            typeFilter.addEventListener('change', filterErrors);
        }

        function startAutoUpdate() {
            const autoRefreshCheck = document.getElementById('auto-refresh');
            
            function updateIfEnabled() {
                if (autoRefreshCheck.checked) {
                    refreshDashboard();
                }
            }

            updateInterval = setInterval(updateIfEnabled, 10000); // 10ç§’ã”ã¨

            autoRefreshCheck.addEventListener('change', function() {
                if (this.checked) {
                    updateIfEnabled();
                } else {
                    console.log('â¸ï¸ è‡ªå‹•æ›´æ–°ã‚’åœæ­¢');
                }
            });
        }

        function refreshDashboard() {
            if (!window.errorHandler) {
                console.warn('âš ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }

            try {
                updateStats();
                updateSeverityBreakdown();
                updateErrorChart();
                updateErrorLog();
                updateLastUpdateTime();
                console.log('âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°å®Œäº†');
            } catch (error) {
                console.error('âŒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        function updateStats() {
            const stats = window.errorHandler.getErrorStats();
            const errorLog = window.errorHandler.getErrorLog(1000);
            
            // ä»Šæ—¥ã®ã‚¨ãƒ©ãƒ¼æ•°ã‚’è¨ˆç®—
            const today = new Date().toDateString();
            const todayErrors = errorLog.filter(entry => 
                new Date(entry.timestamp).toDateString() === today
            ).length;

            document.getElementById('total-errors').textContent = stats.total;
            document.getElementById('critical-errors').textContent = stats.bySeverity.critical || 0;
            document.getElementById('today-errors').textContent = todayErrors;

            // ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ã®åˆ¤å®š
            let health = 'è‰¯å¥½';
            let healthColor = '#388e3c';
            
            const criticalCount = stats.bySeverity.critical || 0;
            if (criticalCount > 5) {
                health = 'è­¦å‘Š';
                healthColor = '#f57c00';
            }
            if (criticalCount > 10) {
                health = 'å±é™º';
                healthColor = '#d32f2f';
            }

            const healthElement = document.getElementById('system-health');
            healthElement.textContent = health;
            healthElement.style.color = healthColor;
        }

        function updateSeverityBreakdown() {
            const stats = window.errorHandler.getErrorStats();
            const container = document.getElementById('severity-breakdown');
            
            const severities = [
                { key: 'critical', label: 'é‡è¦', icon: 'severity-critical' },
                { key: 'high', label: 'é«˜', icon: 'severity-high' },
                { key: 'medium', label: 'ä¸­', icon: 'severity-medium' },
                { key: 'low', label: 'ä½', icon: 'severity-low' }
            ];

            let html = '';
            severities.forEach(severity => {
                const count = stats.bySeverity[severity.key] || 0;
                html += `
                    <div class="severity-item">
                        <div class="severity-label">
                            <div class="severity-icon ${severity.icon}"></div>
                            <span>${severity.label}</span>
                        </div>
                        <span>${count}ä»¶</span>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function updateErrorChart() {
            const errorLog = window.errorHandler.getErrorLog(1000);
            const container = document.getElementById('error-chart');
            
            // éå»7æ—¥é–“ã®æ—¥åˆ¥ã‚¨ãƒ©ãƒ¼æ•°ã‚’é›†è¨ˆ
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push({
                    date: date.toDateString(),
                    label: date.getMonth() + 1 + '/' + date.getDate(),
                    count: 0
                });
            }

            errorLog.forEach(entry => {
                const entryDate = new Date(entry.timestamp).toDateString();
                const day = days.find(d => d.date === entryDate);
                if (day) day.count++;
            });

            const maxCount = Math.max(...days.map(d => d.count), 1);
            
            let html = '';
            days.forEach(day => {
                const height = (day.count / maxCount) * 180;
                html += `
                    <div>
                        <div class="chart-bar" style="height: ${height}px;" title="${day.count}ä»¶"></div>
                        <div class="chart-label">${day.label}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function updateErrorLog() {
            const errorLog = window.errorHandler.getErrorLog(50);
            filterErrors();
        }

        function filterErrors() {
            const errorLog = window.errorHandler.getErrorLog(50);
            const severityFilter = document.getElementById('severity-filter').value;
            const typeFilter = document.getElementById('type-filter').value;

            filteredErrors = errorLog.filter(entry => {
                const severityMatch = !severityFilter || entry.severity === severityFilter;
                const typeMatch = !typeFilter || entry.type === typeFilter;
                return severityMatch && typeMatch;
            });

            displayFilteredErrors();
        }

        function displayFilteredErrors() {
            const container = document.getElementById('error-log-content');
            
            if (filteredErrors.length === 0) {
                container.innerHTML = '<div class="no-errors">ğŸ“‹ ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }

            let html = '';
            filteredErrors.forEach(entry => {
                const timestamp = new Date(entry.timestamp).toLocaleString();
                html += `
                    <div class="log-entry" data-error-id="${entry.id}">
                        <div class="log-entry-header" onclick="toggleLogEntry('${entry.id}')">
                            <div>
                                <div class="log-message">${escapeHtml(entry.message)}</div>
                                <div class="log-meta">
                                    <span>ğŸ•’ ${timestamp}</span>
                                    <span>âš¡ ${entry.type}</span>
                                    <span>ğŸ¯ ${entry.severity}</span>
                                </div>
                            </div>
                            <div>ğŸ‘ï¸</div>
                        </div>
                        <div class="log-entry-content">
                            <div class="log-details">
                                <div class="log-detail-item">
                                    <span class="log-detail-label">ID:</span>
                                    <span>${entry.id}</span>
                                </div>
                                <div class="log-detail-item">
                                    <span class="log-detail-label">ã‚¿ã‚¤ãƒ—:</span>
                                    <span>${entry.type}</span>
                                </div>
                                <div class="log-detail-item">
                                    <span class="log-detail-label">é‡è¦åº¦:</span>
                                    <span>${entry.severity}</span>
                                </div>
                                <div class="log-detail-item">
                                    <span class="log-detail-label">URL:</span>
                                    <span>${escapeHtml(entry.url || 'N/A')}</span>
                                </div>
                                ${entry.context ? `
                                <div class="log-detail-item">
                                    <span class="log-detail-label">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ:</span>
                                    <pre style="background: #f5f5f5; padding: 10px; margin-top: 5px; border-radius: 3px; font-size: 12px;">${escapeHtml(JSON.stringify(entry.context, null, 2))}</pre>
                                </div>
                                ` : ''}
                                ${entry.stack ? `
                                <div class="log-detail-item">
                                    <span class="log-detail-label">ã‚¹ã‚¿ãƒƒã‚¯:</span>
                                    <pre style="background: #f5f5f5; padding: 10px; margin-top: 5px; border-radius: 3px; font-size: 12px;">${escapeHtml(entry.stack)}</pre>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function toggleLogEntry(errorId) {
            const entry = document.querySelector(`[data-error-id="${errorId}"]`);
            if (entry) {
                entry.classList.toggle('expanded');
            }
        }

        function testError() {
            if (window.errorHandler) {
                // ãƒ†ã‚¹ãƒˆç”¨ã‚¨ãƒ©ãƒ¼ã‚’ç”Ÿæˆ
                const testErrors = [
                    new Error('ãƒ†ã‚¹ãƒˆç”¨JavaScript ã‚¨ãƒ©ãƒ¼'),
                    new Error('ãƒ†ã‚¹ãƒˆç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: connection failed'),
                    new Error('ãƒ†ã‚¹ãƒˆç”¨èªè¨¼ã‚¨ãƒ©ãƒ¼: permission denied'),
                    new Error('ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼: validation failed')
                ];

                const randomError = testErrors[Math.floor(Math.random() * testErrors.length)];
                window.errorHandler.handleError(randomError, { source: 'test', timestamp: Date.now() });
                
                alert('ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼ã‚’ç”Ÿæˆã—ã¾ã—ãŸ');
                setTimeout(refreshDashboard, 100);
            }
        }

        function clearErrorLog() {
            if (confirm('ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’å…¨ã¦å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                window.errorHandler.clearErrorLog();
                refreshDashboard();
            }
        }

        function exportLog() {
            const errorLog = window.errorHandler.getErrorLog(20);
            const dataStr = JSON.stringify(errorLog, null, 2);
            downloadData(dataStr, 'error-log.json');
        }

        function exportFullLog() {
            const errorLog = window.errorHandler.getErrorLog(1000);
            const dataStr = JSON.stringify(errorLog, null, 2);
            downloadData(dataStr, 'full-error-log.json');
        }

        function exportStats() {
            const stats = window.errorHandler.getErrorStats();
            const dataStr = JSON.stringify(stats, null, 2);
            downloadData(dataStr, 'error-stats.json');
        }

        function downloadData(dataStr, filename) {
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function updateLastUpdateTime() {
            document.getElementById('last-update').textContent = new Date().toLocaleTimeString();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function closeModal() {
            document.getElementById('error-detail-modal').style.display = 'none';
        }

        // ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        window.addEventListener('beforeunload', function() {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });
    </script>
</body>
</html>
