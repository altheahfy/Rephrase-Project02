# ç§»æ¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ - Individual Engine to Unified Mapper

## ğŸ“‹ ç§»æ¤å¯¾è±¡ã‚¨ãƒ³ã‚¸ãƒ³ä¸€è¦§

### âœ… å„ªå…ˆåº¦1 (Phase 1-5: åŸºç¤æ§‹æ–‡)

- [x] **basic_five_pattern_engine.py** (âœ…å®Œäº† - Phase 1)
  - æ©Ÿèƒ½: åŸºæœ¬5æ–‡å‹å‡¦ç† (SV, SVC, SVO, SVOO, SVOC)
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_basic_five_pattern()`
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The man is strong." / "He bought a car."
  - é‡è¦åº¦: â­â­â­ **åŸºç›¤ã‚¨ãƒ³ã‚¸ãƒ³ãƒ»å®Œäº†æ¸ˆã¿**

- [x] **simple_relative_engine.py** (âœ…å®Œäº† - Phase 2) 
  - æ©Ÿèƒ½: é–¢ä¿‚ç¯€å‡¦ç† (acl:relcl, nsubj, obj, nmod:poss, advmod)  
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_relative_clause()`
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The car which we saw was red."
  - è²¬ä»»ç¯„å›²: **é–¢ä¿‚ç¯€ã®ã¿**ï¼ˆä¸»æ–‡å‡¦ç†ã¯5æ–‡å‹ã‚¨ãƒ³ã‚¸ãƒ³ã«å§”è­²ï¼‰

- [x] **passive_voice_engine.py** (âœ…å®Œäº† - Phase 2)
  - æ©Ÿèƒ½: å—å‹•æ…‹å‡¦ç† (nsubj:pass, aux:pass, obl:agent)
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_passive_voice()`  
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The car was bought by him."
  - è²¬ä»»ç¯„å›²: **æ–‡å‹å¤‰æ›å‡¦ç†**ï¼ˆä¸»æ–‡Vå‡¦ç†å«ã‚€ï¼‰

- [ ] **adverb_engine.py** (æ–°è¦å®Ÿè£…)
  - æ©Ÿèƒ½: å‰¯è©å˜ç‹¬å‡¦ç† (advmodä¾å­˜é–¢ä¿‚å°‚é–€å‡¦ç†)
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_adverb()`
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The man runs fast." / "She speaks very clearly."
  - å‡¦ç†å¯¾è±¡: æ§˜æ…‹å‰¯è©(M2), ç¨‹åº¦å‰¯è©(åŸ‹è¾¼), å¦å®šå‰¯è©(M3), æ™‚é–“å‰¯è©(M1)

- [ ] **article_determiner_engine.py** (æ–°è¦å®Ÿè£…) ğŸ†•
  - æ©Ÿèƒ½: å† è©ãƒ»å®šå† è©å‡¦ç† (detä¾å­˜é–¢ä¿‚å°‚é–€å‡¦ç†)
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_article_determiner()`
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The car is red." â†’ S: "The car" / "A book was bought." â†’ S: "A book"
  - å‡¦ç†å¯¾è±¡: å®šå† è©(the), ä¸å®šå† è©(a/an), æ•°é‡è©(some/many), æ‰€æœ‰æ ¼(my/your)
  - é‡è¦åº¦: â­â­ **åŸºæœ¬æ–‡å¤‰æ›ãƒ»å¿…é ˆæ©Ÿèƒ½**

- [ ] **article_determiner_engine.py** (æ–°è¦ä½œæˆ - Phase 3)
  - æ©Ÿèƒ½: å† è©ãƒ»å®šå† è©å‡¦ç† (det dependency)  
  - å‡¦ç†å¯¾è±¡: the, a, an, this, that, my, your, ãªã©ã®deté–¢ä¿‚
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "The car is red." â†’ S: "The car"
  - ç›®çš„: åè©å¥ã®å®Œå…¨æ€§ç¢ºä¿ï¼ˆç¾åœ¨"The car"ãŒ"car"ã®ã¿ã«ãªã‚‹å•é¡Œã‚’è§£æ±ºï¼‰
  - é‡è¦åº¦: â­â­ **åè©å¥æŠ½å‡ºå®Œå…¨æ€§ãƒ»å¿…é ˆ**

### âš¡ å„ªå…ˆåº¦2 (Phase 5-7: å¥æ§‹é€ ãƒ»å¾“å±ç¯€)

- [ ] **stanza_based_conjunction_engine.py** (218è¡Œ)
  - æ©Ÿèƒ½: å¾“å±æ¥ç¶šè©å‡¦ç† (mark, advcl, æ„å‘³åˆ†é¡)
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_conjunction()`
  - ãƒ†ã‚¹ãƒˆä¾‹æ–‡: "I came because it rained."

- [ ] **progressive_tenses_engine.py** 
  - æ©Ÿèƒ½: é€²è¡Œå½¢å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_progressive()`

- [ ] **prepositional_phrase_engine.py**
  - æ©Ÿèƒ½: å‰ç½®è©å¥å‡¦ç†  
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_prepositional_phrase()`

- [ ] **perfect_progressive_engine.py**
  - æ©Ÿèƒ½: å®Œäº†é€²è¡Œå½¢å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_perfect_progressive()`

### ğŸ”§ å„ªå…ˆåº¦3 (Phase 8-10: æº–å‹•è©)
- [ ] **participle_engine.py**
  - æ©Ÿèƒ½: åˆ†è©å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_participle()`

- [ ] **gerund_engine.py** 
  - æ©Ÿèƒ½: å‹•åè©å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_gerund()`

- [ ] **infinitive_engine.py**
  - æ©Ÿèƒ½: ä¸å®šè©å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_infinitive()`

### ğŸ¯ å„ªå…ˆåº¦4 (Phase 11-13: ç‰¹æ®Šæ§‹æ–‡)
- [ ] **question_formation_engine.py**
  - æ©Ÿèƒ½: ç–‘å•æ–‡å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_question()`

- [ ] **subjunctive_conditional_engine.py**
  - æ©Ÿèƒ½: ä»®å®šæ³•ãƒ»æ¡ä»¶æ³•å‡¦ç†  
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_subjunctive_conditional()`

- [ ] **inversion_engine.py**
  - æ©Ÿèƒ½: å€’ç½®æ§‹æ–‡å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_inversion()`

### ğŸ“Š å„ªå…ˆåº¦5 (Phase 14-16: ãã®ä»–ãƒ»åŸºç¤)
- [ ] **comparative_superlative_engine.py**
  - æ©Ÿèƒ½: æ¯”è¼ƒãƒ»æœ€ä¸Šç´šå‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_comparative()`

- [ ] **basic_five_pattern_engine.py**
  - æ©Ÿèƒ½: åŸºæœ¬5æ–‡å‹å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_basic_five_pattern()`

- [ ] **modal_engine.py**
  - æ©Ÿèƒ½: æ³•åŠ©å‹•è©å‡¦ç†
  - ç§»æ¤å…ˆãƒ¡ã‚½ãƒƒãƒ‰: `_handle_modal()`

---

## ğŸ“ ç§»æ¤ä½œæ¥­æ‰‹é †

### å„ã‚¨ãƒ³ã‚¸ãƒ³ã®ç§»æ¤ã‚¹ãƒ†ãƒƒãƒ—
1. **ã‚³ãƒ¼ãƒ‰è§£æ**: ç§»æ¤å…ƒã‚¨ãƒ³ã‚¸ãƒ³ã®ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç‰¹å®š
2. **ä¾å­˜é–¢ä¿‚ç¢ºèª**: Stanzaè§£æã€ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ãªã©
3. **ãƒ¡ã‚½ãƒƒãƒ‰æŠ½å‡º**: æ ¸å¿ƒãƒ­ã‚¸ãƒƒã‚¯ã‚’çµ±åˆãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã«èª¿æ•´
4. **çµ±åˆå®Ÿè£…**: `_handle_xxx()` ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦UnifiedMapperã«è¿½åŠ 
5. **å˜ä½“ãƒ†ã‚¹ãƒˆ**: è©²å½“æ–‡æ³•ã®å‹•ä½œç¢ºèª
6. **çµ±åˆãƒ†ã‚¹ãƒˆ**: æ—¢å­˜æ©Ÿèƒ½ã¨ã®è¤‡åˆå‹•ä½œç¢ºèª
7. **å›å¸°ãƒ†ã‚¹ãƒˆ**: æ—¢å­˜æ©Ÿèƒ½ã®åŠ£åŒ–ãŒãªã„ã“ã¨ã‚’ç¢ºèª

### ç§»æ¤æ™‚ã®æ³¨æ„äº‹é …
- **Stanzaãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: æ—¢å­˜ã®`self.nlp`ã‚’æ´»ç”¨
- **ã‚¹ãƒ­ãƒƒãƒˆå‘½å**: Rephraseè¦ç´„ã«æº–æ‹  (S, V, O1, sub-s, sub-v, etc.)
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: çµ±åˆã‚·ã‚¹ãƒ†ãƒ ç”¨ã«èª¿æ•´
- **ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›**: çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã«åˆã‚ã›ã‚‹

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### æ®µéšçš„ãƒ†ã‚¹ãƒˆ
```python
# test_unified_mapper.py ã§ã®æ¤œè¨¼é …ç›®

Phase 1: é–¢ä¿‚ç¯€ã®ã¿
âœ… "The car which we saw was red."
âœ… "The man who runs is fast."
âœ… "The place where I live is Tokyo."

Phase 2: é–¢ä¿‚ç¯€ + å—å‹•æ…‹
âœ… "The car was bought."  
âœ… "The car which was bought was red."
âœ… "The book which was read by him is interesting."

Phase 3: é–¢ä¿‚ç¯€ + å—å‹•æ…‹ + å‰¯è©
âœ… "The man who runs fast is my friend."
âœ… "She speaks very clearly."
âœ… "He doesn't work hard."

Phase 4: é–¢ä¿‚ç¯€ + å—å‹•æ…‹ + å‰¯è© + æ¥ç¶šè©
âœ… "Because the car which was bought quickly was red, he liked it."
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- å‡¦ç†æ™‚é–“æ¸¬å®š (1æ–‡ã‚ãŸã‚Š0.1-0.3ç§’ç›®æ¨™)
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦– (50MBä»¥ä¸‹)
- è¤‡é›‘æ–‡ã§ã®å®‰å®šæ€§ç¢ºèª

---

## ğŸ“Š é€²æ—ç®¡ç†

### å®Œäº†ãƒã‚§ãƒƒã‚¯
- [ ] Phase 0: åŸºç›¤æ§‹ç¯‰
- [ ] Phase 1: é–¢ä¿‚ç¯€ç§»æ¤
- [ ] Phase 2: å—å‹•æ…‹ç§»æ¤  
- [ ] Phase 3: å‰¯è©ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…ï¼ˆæ–°è¦ï¼‰
- [ ] Phase 4: æ¥ç¶šè©ç§»æ¤
- [ ] Phase 5-16: æ®µéšçš„æ‹¡å¼µ
- [ ] Phase 17: çµ±åˆãƒ»æœ€é©åŒ–

### å“è³ªåŸºæº–
å„Phaseå®Œäº†æ™‚ã«ä»¥ä¸‹ã‚’ã‚¯ãƒªã‚¢:
- âœ… å˜ä½“ãƒ†ã‚¹ãƒˆ100%æˆåŠŸ
- âœ… çµ±åˆãƒ†ã‚¹ãƒˆ95%ä»¥ä¸ŠæˆåŠŸ  
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–å†…
- âœ… æ—¢å­˜æ©Ÿèƒ½åŠ£åŒ–ãªã—

---

## ğŸ”— å‚è€ƒãƒ•ã‚¡ã‚¤ãƒ«

### ç§»æ¤å…ƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```
migration_source/
â”œâ”€â”€ simple_relative_engine.py           # é–¢ä¿‚ç¯€å‡¦ç†ã®å‚è€ƒå®Ÿè£…
â”œâ”€â”€ passive_voice_engine.py             # å—å‹•æ…‹å‡¦ç†ã®å‚è€ƒå®Ÿè£…
â”œâ”€â”€ stanza_based_conjunction_engine.py  # æ¥ç¶šè©å‡¦ç†ã®å‚è€ƒå®Ÿè£…
â”œâ”€â”€ ...
â””â”€â”€ (å…¨15å€‹åˆ¥ã‚¨ãƒ³ã‚¸ãƒ³)
```

### é–‹ç™ºãƒ•ã‚¡ã‚¤ãƒ«
- `unified_stanza_rephrase_mapper.py` - çµ±åˆãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«
- `test_unified_mapper.py` - ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ 
- `Unified_Mapper_Design_Spec.md` - è¨­è¨ˆä»•æ§˜æ›¸

---

**æ›´æ–°å±¥æ­´**:
- 2025/08/15: åˆç‰ˆä½œæˆ
- (é€²è¡Œã«å¿œã˜ã¦æ›´æ–°äºˆå®š)
