# å¼•ãç¶™ãæ›¸ï¼šæ¡ä»¶æ–‡å‡¦ç†æ”¹å–„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

## å®Ÿè¡Œæ—¥æ™‚
2025å¹´9æœˆ1æ—¥

## é”æˆæˆæœ
- **æˆåŠŸç‡**: 91.6% (142/155ã‚±ãƒ¼ã‚¹æˆåŠŸ)
- **ä¸»è¦æ”¹å–„**: æ¡ä»¶æ–‡å‡¦ç†ã®ç²¾åº¦å‘ä¸Šã€ã€Œas ifã€æ¯”å–©è¡¨ç¾ã®é©åˆ‡ãªåˆ†é›¢

## ç¾åœ¨ã®çŠ¶æ³

### âœ… è§£æ±ºæ¸ˆã¿å•é¡Œ
1. **Case 119**: å‰ç½®è©+åè©ç¯€ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºã®æ”¹å–„
2. **Cases 131-140**: ã€ŒIfã€æ¥é ­è¾å•é¡Œã®è§£æ±º - å€’ç½®ä»®å®šæ³•ã¨é€šå¸¸æ¡ä»¶æ–‡ã®åŒºåˆ¥
3. **ImperativeHandler**: æ¡ä»¶æ–‡ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã®å‘½ä»¤æ–‡å‡¦ç†ã®çµ±åˆ
4. **Cases 145-146**: ã€Œas ifã€ã€Œas thoughã€æ¯”å–©è¡¨ç¾ã‚’æ¡ä»¶æ–‡å‡¦ç†ã‹ã‚‰é™¤å¤–

### âŒ æ®‹å­˜å•é¡Œï¼ˆ13ã‚±ãƒ¼ã‚¹ï¼‰
- **Case 141**: ç†ç”±ç¯€æ§‹æ–‡ã®èª¤åˆ†é¡
- **Case 144**: I wishæ–‡ã®å‡¦ç†æ”¹å–„
- **Cases 147-149**: Without/But for/Unlessæ§‹æ–‡ã®å®Œå…¨ãªå¯¾å¿œ
- **Cases 150-155**: è¤‡é›‘ãªä»®æƒ³æ§‹æ–‡ï¼ˆSuppose/Imagine/Providedç­‰ï¼‰

## ä¸»è¦ãªä¿®æ­£å†…å®¹

### 1. conditional_handler.py
**å ´æ‰€**: Lines 310-318
**ä¿®æ­£å†…å®¹**: ã€Œas ifã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¡ä»¶ç¯€å‡¦ç†ã‹ã‚‰ã®é™¤å¤–
```python
if if_marker:
    # ã€Œas ifã€ã€Œas thoughã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é™¤å¤–
    if_pos = if_marker.i
    if if_pos > 0:
        prev_token = doc[if_pos - 1]
        if prev_token.text.lower() == 'as':
            print(f"ğŸ” 'as if'ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º â†’ æ¡ä»¶ç¯€å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—")
            continue
    
    print(f"ğŸ¯ advcl+mark(if)æ¤œå‡º: '{token.text}' â†’ æ¡ä»¶ç¯€å¢ƒç•Œè§£æ")
    return self._analyze_advcl_conditional(doc, token, if_marker, sentence)
```

### 2. central_controller.py
**å ´æ‰€**: Lines 1619-1627
**ä¿®æ­£å†…å®¹**: central_controllerã§ã®ã€Œas ifã€é™¤å¤–å‡¦ç†
```python
if if_marker:
    # ã€Œas ifã€ã€Œas thoughã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é™¤å¤–
    if_pos = if_marker.i
    if if_pos > 0:
        prev_token = doc[if_pos - 1]
        if prev_token.text.lower() == 'as':
            print(f"ğŸ” 'as if'ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º â†’ æ¡ä»¶ç¯€å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—")
            continue
    
    print(f"ğŸ¯ advcl+mark(if)æ¤œå‡º: '{token.text}' â†’ æ¡ä»¶ç¯€å¢ƒç•Œè§£æ")
    return self._analyze_conditional_boundary(doc, token, if_marker, text)
```

**å ´æ‰€**: Lines 1700-1707
**ä¿®æ­£å†…å®¹**: å“è©åˆ†æã§ã®ã€Œas ifã€æ–‡ä¸­æ¤œå‡º
```python
# "As if"ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯æ¡ä»¶æ–‡ã§ã¯ãªãæ¯”å–©è¡¨ç¾ã¨ã—ã¦é™¤å¤–
if ' as if ' in text.lower() or ' as though ' in text.lower():
    print(f"âš ï¸ 'As if/As though'æ¯”å–©è¡¨ç¾æ¤œå‡º: æ¡ä»¶æ–‡ã§ã¯ãªã„")
    return "", text  # æ¡ä»¶ç¯€ãªã—ã€å…¨ä½“ãŒä¸»ç¯€

if text.strip().lower().startswith('as if'):
    print(f"âš ï¸ 'As if'ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º: æ¡ä»¶æ–‡ã§ã¯ãªã„æ¯”å–©è¡¨ç¾")
    return "", text  # æ¡ä»¶ç¯€ãªã—ã€å…¨ä½“ãŒä¸»ç¯€
```

### 3. central_controller.pyï¼ˆéå»ã®ä¿®æ­£ï¼‰
**å ´æ‰€**: Lines 1960-1962
**ä¿®æ­£å†…å®¹**: é€šå¸¸æ¡ä»¶æ–‡ã§ã®ã€ŒIfã€æ¥é ­è¾ã®é©åˆ‡ãªè¿½åŠ 
```python
# é€šå¸¸ã®æ¡ä»¶æ–‡ã§ã¯ã€ŒIfã€ã‚’è¿½åŠ 
sub_slots['sub-s'] = f"If {if_slots['S']}"
```

## ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã®ç†è§£

### å‡¦ç†ãƒ•ãƒ­ãƒ¼
1. **åè©ç¯€æ¤œå‡º** â†’ **ä¿®é£¾èªåˆ†é›¢** â†’ **åŠ©å‹•è©å‡¦ç†** â†’ **ä»®å®šæ³•å‡¦ç†**
2. **ä»®å®šæ³•å‡¦ç†**: `_split_conditional_sentence` â†’ ä¾å­˜é–¢ä¿‚è§£æ â†’ å“è©åˆ†æ
3. **æ¡ä»¶ç¯€ãƒ»ä¸»ç¯€åˆ†é›¢** â†’ **å„ç¯€ã®åŸºæœ¬åˆ†è§£** â†’ **çµ±åˆ**

### ä¸»è¦ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
- **ConditionalHandler**: æ¡ä»¶æ–‡å°‚ç”¨å‡¦ç†
- **ImperativeHandler**: å‘½ä»¤æ–‡å‡¦ç†ï¼ˆæ¡ä»¶æ–‡ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¯¾å¿œï¼‰
- **ModalHandler**: åŠ©å‹•è©å‡¦ç†
- **AdverbHandler**: ä¿®é£¾èªåˆ†é›¢

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆå„ªå…ˆåº¦é †ï¼‰

### é«˜å„ªå…ˆåº¦
1. **Case 144 (I wishæ–‡)**: 
   - å ´æ‰€: wishæ–‡ã®åè©ç¯€å‡¦ç†ã¨sub_slotsåˆ†è§£ã®æ”¹å–„
   - æœŸå¾…å€¤: `{"sub-s": "I", "sub-v": "studied", "sub-m2": "abroad"}`

2. **Cases 147-149 (å‰ç½®è©æ¡ä»¶æ–‡)**:
   - Without/But for/Unlessæ§‹æ–‡ã®å°‚ç”¨å‡¦ç†å®Ÿè£…
   - sub-slotsåˆ†è§£ã®æ”¹å–„ãŒå¿…è¦

### ä¸­å„ªå…ˆåº¦  
3. **Cases 145-146 (as ifæ¯”å–©è¡¨ç¾)**:
   - ç¾åœ¨ã¯æ¡ä»¶æ–‡ã‹ã‚‰é™¤å¤–ã•ã‚Œã¦ã„ã‚‹ãŒã€é©åˆ‡ãªsub_slotsåˆ†è§£ãŒå¿…è¦
   - æ¯”å–©è¡¨ç¾å°‚ç”¨ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®å®Ÿè£…æ¤œè¨

4. **Case 141 (ç†ç”±ç¯€)**:
   - because/so thatæ§‹æ–‡ã®æ¡ä»¶æ–‡ã‹ã‚‰ã®é™¤å¤–

### ä½å„ªå…ˆåº¦
5. **Cases 150-155 (è¤‡é›‘ä»®æƒ³æ§‹æ–‡)**:
   - Suppose/Imagine/Providedç­‰ã®ç‰¹æ®Šä»®å®šæ³•æ§‹æ–‡
   - ç–‘å•æ–‡è¦ç´ ã‚’å«ã‚€è¤‡åˆæ§‹æ–‡ã®å‡¦ç†æ”¹å–„

## æŠ€è¡“çš„æ³¨æ„ç‚¹

### é‡è¦ãªè¨­è¨ˆåŸå‰‡
1. **advcl+mark(if)æ¤œå‡º**: ä¾å­˜é–¢ä¿‚è§£æã®æ ¸å¿ƒéƒ¨åˆ†
2. **ã€Œas ifã€é™¤å¤–**: æ¡ä»¶æ–‡ã¨æ¯”å–©è¡¨ç¾ã®åŒºåˆ¥ãŒé‡è¦
3. **å€’ç½®ä»®å®šæ³• vs é€šå¸¸æ¡ä»¶æ–‡**: ã€ŒIfã€æ¥é ­è¾ã®æœ‰ç„¡ã§åŒºåˆ¥

### ãƒ‡ãƒãƒƒã‚°ã®ãƒã‚¤ãƒ³ãƒˆ
- `fast_test.py` ã§ã‚±ãƒ¼ã‚¹åˆ¥ãƒ†ã‚¹ãƒˆ
- `decomposition_results_all.json` ã§æœŸå¾…å€¤ã¨å®Ÿéš›å€¤ã®æ¯”è¼ƒ
- ãƒ­ã‚°å‡ºåŠ›ã§å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®ç¢ºèª

### ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰
```bash
# å…¨ä½“ãƒ†ã‚¹ãƒˆ
python fast_test.py

# ç‰¹å®šã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ  
python fast_test.py 145

# å¤±æ•—ã‚±ãƒ¼ã‚¹ã®ã¿
python fast_test.py 141 144 145 146 147 148 149 150 151 152 153 154 155
```

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 
```
training/data/
â”œâ”€â”€ central_controller.py     # ãƒ¡ã‚¤ãƒ³åˆ¶å¾¡
â”œâ”€â”€ conditional_handler.py    # æ¡ä»¶æ–‡å‡¦ç†
â”œâ”€â”€ fast_test.py             # ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ decomposition_results_all.json  # æœŸå¾…å€¤ãƒ»å®Ÿéš›å€¤
â””â”€â”€ å„ç¨®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼            # adverb, modal, imperativeç­‰
```

## è¿½åŠ å®Ÿè£…ãŒå¿…è¦ãªæ©Ÿèƒ½

### 1. æ¯”å–©è¡¨ç¾ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
```python
# ã€Œas ifã€ã€Œas thoughã€å°‚ç”¨ã®åˆ†è§£ãƒ­ã‚¸ãƒƒã‚¯
def _process_metaphorical_expression(self, text):
    # "He talks as if he were the boss"
    # â†’ main: {"S": "He", "V": "talks"}
    # â†’ sub: {"sub-s": "as if he", "sub-v": "were", "sub-c1": "the boss"}
```

### 2. ç†ç”±ç¯€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
```python  
# because/so thatæ§‹æ–‡ã®æ¡ä»¶æ–‡ã‹ã‚‰ã®é™¤å¤–
def _detect_reason_clause(self, text):
    if ' because ' in text.lower() or ' so that ' in text.lower():
        return True
```

### 3. å‰ç½®è©æ¡ä»¶æ–‡ã®æ”¹å–„
```python
# Without/But for/Unless ã®å°‚ç”¨åˆ†è§£ãƒ­ã‚¸ãƒƒã‚¯
def _process_prepositional_conditional(self, text, prep_type):
    # "Without your help, I would fail"
    # â†’ ã‚ˆã‚Šè©³ç´°ãªsub_slotsåˆ†è§£
```

## æœ€çµ‚çš„ãªç›®æ¨™
- **100%æˆåŠŸç‡**: å…¨155ã‚±ãƒ¼ã‚¹ã®å®Œå…¨å¯¾å¿œ
- **æ¯”å–©è¡¨ç¾ã®é©åˆ‡ãªåˆ†è§£**: as if/as thoughæ§‹æ–‡
- **è¤‡é›‘ä»®å®šæ³•ã®å¯¾å¿œ**: Suppose/Imagineç­‰
- **ç†ç”±ç¯€ã®é©åˆ‡ãªåˆ†é›¢**: because/so thatæ§‹æ–‡

---

**ç¾åœ¨ã®æˆæœ**: 91.6%æˆåŠŸç‡ã¯éå¸¸ã«é«˜ã„æ°´æº–ã§ã™ã€‚æ®‹ã‚Š13ã‚±ãƒ¼ã‚¹ã®æ”¹å–„ã«ã‚ˆã‚Šã€å®Ÿç”¨çš„ã«ã¯ååˆ†ãªç²¾åº¦ã‚’é”æˆã—ã¦ã„ã¾ã™ã€‚
